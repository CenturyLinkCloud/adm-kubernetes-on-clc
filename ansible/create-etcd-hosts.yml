---
- name: Check ansible version
  hosts: localhost0
  gather_facts: False
  connection: local
  tasks:
    - fail: msg="This playbook requires Ansible 2.0 or greater (found {{ ansible_version.full }})."
      when: "{{ ansible_version|version_compare(2.0,'<') }}"

- name: Get machine resources for etcd
  hosts: localhost
  gather_facts: False
  connection: local
  vars:
    - clc_cluster_name: k8s
    - ansible_hosts_directory: "{{ clc_cluster_name }}.d"
    - server_group: etcd
    - datacenter: VA1
    - server_count: 3
    - server_memory: 2
    - server_cpu: 1
    - skip_etcd: False
    - async_time: 7200
    - async_poll: 5

  roles:
    - { role: clc-provisioning, when: skip_etcd == False }
